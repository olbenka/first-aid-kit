# first-aid-kit
# Описание
## Наименование 
Телеграм-бот аптечка \
https://t.me/firstAidKitInfoBot
## Предметная область
Хранение и контроль важных данных о медикаментах.
## Описание функций 
### Функциональность 
Для удобства контроля информации о медикаментах создан телеграм-бот. 
* Регистрация пользователя и подтверждение регистрации по email.
* Добавление информации о медикаментах с указанием количества, краткой важной информации, сроков годности. Также к медикаменту можно добавить фотографию (в исходном или в сжатом виде). Такой вид информации аналогичен разделу "Форма выпуска" в стандартных инструкциях по применению. Для даты: если вводимая дата имеет срок годности, приближающийся к концу (отличается на 1 месяц или менее), пользователь получает предупреждение об истекающем сроке годности.  
* Получение информации о медикаментах. Имеются две команды: получение всей информации и частичной. Второй вариант даёт информацию по названию и требуемым данным. При выборе пункта "фото" генерируется ссылка для скачивания фотографии. 
* Удаление медикамента по названию. 
* Прием медикамента. Вводится название и количество препарата. Количество обновляется. Если медикамента недостаточно, то пользователь получает уведомление об этом. Если после приема медикамента количество обнулилось, медикамент автоматически удаляется из базы данных.
* Просмотр медикаментов, у которых скоро закончится срок годности (сравнивается с now()).

### Список команд
Список команд, которые поддерживаются в этом боте:
- `/cancel` - отмена выполнения текущей команды
- `/registration` - регистрация пользователя
- `/add` - добавить медикамент
- `/allinfo` - список всех медикаментов с остатком
- `/info` - информация о конкретном препарате
- `/delete` - удалить медикамент
- `/take` - принять медикамент
- `/showexpiringsoon` - показать медикаменты, срок годности которых заканчивается через месяц или меньше.

# Данные
![Image alt](https://github.com/olbenka/first-aid-kit/blob/main/ER_diagram.jpg)
## Для каждого элемента данных - ограничения
### Medication 
* id (PK): уникальный идентификатор, генерируется автоматически.
* name: наименование медикамента (не должно быть пустым).
* quantity: количество медикамента (> 0, при значении 0 медикамент удаляется).
* expiryDate: дата окончания срока годности (должна быть в будущем, вводится в формате ММ.ГГГГ, дата должна быть корректной).
* briefInfo: краткая информация о медикаменте (не может быть пустым).
* photo (FK): id фотография медикамента (ссылка на AppPhoto).
* document (FK): id документ медикаментa (ссылка на AppDocument).
* user (FK): id пользователь, которому принадлежит медикамент (ссылка на AppUser).
### BinaryContent
* id (PK): Уникальный идентификатор, генерируется автоматически.
* fileAsArrayOfBytes: Массив байтов. (не может быть пустым).
### AppUser
* id (PK): Уникальный идентификатор (генерируется автоматически).
* telegramUserId: Идентификатор пользователя в Telegram (уникален, генерируется автоматически).
* firstLoginDate: Дата первого входа в приложение (генерируется автоматически). 
* firstName: Имя пользователя (не может быть пустым).
* userName: Имя пользователя в Telegram (уникально).
* email: Электронная почта пользователя (уникальна, должна соответствовать формату электронной почты).
* isActive: Статус активности пользователя (true/false).
* userState: Состояние пользователя. Принимает различные значения во время ввода данных. 
### AppPhoto
* id (PK): Уникальный идентификатор (генерируется автоматически).
* telegramFileId: Идентификатор файла в Telegram (уникален)
* binaryContent_id (FK): Внешний ключ, связывает с таблицей BinaryContent.
* fileSize: Размер файла фотографии (неотрицательно).
### AppDocument
* id (PK): Уникальный идентификатор, генерируется автоматически.
* telegramFileId: Идентификатор файла в Telegram (уникален).
* docName: Наименование документа (не может быть пустым).
* binaryContent_id (FK): Внешний ключ, связывает с таблицей BinaryContent.
* mimeType: Тип содержимого документа.
* fileSize: Размер файла документа (неотрицательно).
## Общие ограничения целостности
* Уникальность идентификаторов в каждой таблице (id).
* Связи между таблицами через внешние ключи.
# Пользовательские роли
### Пользователь
Ответственность: ввод и учет медикаментов, мониторинг сроков годности, корректность вводимой почты.
Количество пользователей: неограниченно.
### Администратор
Ответственность: управление пользователями, доступ к данным.
Количество пользователей: 1.

# UI / API 
Проект реализован через Telegram Bot API.
UI бота приведено в папке screens.
# Технологии разработки
Docker, Flyway, RabbitMQ
## Язык программирования 
Java 11 \
Spring
## СУБД
PostgreSQL
# Тестирование
Проводилось вручную
